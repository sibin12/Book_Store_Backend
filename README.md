# Book Store Backend

## Overview

This project implements the backend for a book store application, focusing on user management, book management, purchase history, and revenue tracking for authors.

## Logic for Computing sellCount

The sellCount attribute of each book is computed dynamically based on the purchase history. Whenever a user purchases a book, the sellCount of that book is incremented by the quantity purchased. This ensures that the sellCount accurately reflects the number of times a book has been sold.

## Mechanism for Sending Email Notifications

Email notifications are sent using Nodemailer, a module for Node.js applications that allows sending email. 

### Purchase Notifications

When a user purchases a book, an email notification is sent to the author about the purchase.

### Revenue Notifications

Revenue notifications are sent to authors on a monthly basis using the node-cron module to schedule email sending at regular intervals. Each month, the system calculates the revenue generated from book sales for each author and sends an email containing revenue details, including the total revenue for the current month and year.

### Bulk Email Notifications for New Book Releases

The application uses Agenda, a job scheduling library for Node.js backed by MongoDB, to handle the bulk email notifications. When a new book is released, email notifications are sent to all retail users.

## Database Design and Implementation

### Users

The users collection stores information about the users of the application. Each user has the following attributes:

* _id: A unique identifier for each user, generated by the database.
* username: The username chosen by the user for authentication and identification within the system.
* email: The email address associated with the user's account. This serves as a unique identifier and is also used for communication purposes.
* role: Indicates the role of the user within the system. Possible roles include:
  * admin
  * author
  * retail_user

### Books

The books collection stores information about the books available in the store. Each book is represented as a document with the following attributes:

* bookId: Unique identifier for the book.
* title: Title of the book.
* authors: An array of strings representing the authors of the book.
* description: Description or summary of the book.
* price: Price of the book.
* sellCount: Number of times the book has been sold.
* reviews: An array of embedded documents containing reviews for the book. Each review document includes:
  * rating: Numeric rating given by the user (e.g., 1 to 5 stars).
  * comment: Textual comment provided by the user.
  * userId: Unique identifier of the user who posted the review.

### Purchase History

The purchaseHistory collection maintains records of book purchases made by users. Each purchase record is represented as a document with the following attributes:

* purchaseId: Unique identifier for the purchase.
* bookId: ObjectId reference to the book document that was purchased.
* userId: ObjectId reference to the user who made the purchase.
* purchaseDate: Date and time when the purchase was made.
* price: Price of the book at the time of purchase.
* quantity: Number of copies of the book purchased.

## Usage

1. Clone the repository: `git clone https://github.com/sibin12/Book_Store_Backend.git`
  
2. Install dependencies: `npm install`

3. Run the application: `npm start`

## Get in Touch

Your feedback, suggestions, and contributions are invaluable to us! If you have any ideas, feature requests, or bug reports, please don't hesitate to reach out.

Contact Information:

Email: sibinthekkel@gmail.com

Feel free to contact us with any questions or proposals. I look forward to hearing from you!

